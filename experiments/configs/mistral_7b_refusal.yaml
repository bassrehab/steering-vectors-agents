# Experiment Configuration: Mistral-7B Refusal Steering
# Date: 2025-12-17
# Status: COMPLETED - POSITIVE RESULT

experiment:
  name: "refusal_mistral_7b"
  description: "Refusal steering vector extraction and evaluation on Mistral-7B-Instruct-v0.2"
  rationale: "Mistral is known for weaker built-in refusal, making it a better candidate to demonstrate steering vector effectiveness"
  date_started: "2025-12-17"
  date_completed: "2025-12-17"

model:
  name: "mistralai/Mistral-7B-Instruct-v0.2"
  type: "causal_lm"
  parameters: "7B"
  dtype: "float16"
  source: "huggingface"
  license: "apache-2.0"
  num_layers: 32

hardware:
  device: "mps"
  machine: "Apple M4 Pro"
  memory: "48GB"

extraction:
  method: "caa"
  behavior: "refusal"
  num_contrast_pairs: 50
  layers_extracted: [12, 14, 16, 18, 20]
  best_layer: 12
  token_position: "last"
  vector_norms:
    layer_12: 3.10
    layer_14: 4.04
    layer_16: 5.66
    layer_18: 7.50
    layer_20: 9.23

results:
  # Initial quick evaluation (4 harmful, 2 benign)
  initial:
    base_refusal_rate: 0.75
    steered_refusal_rate: 1.0
    improvement: 0.25
  # Fair comparison evaluation (20 harmful, 20 benign)
  fair_comparison:
    base:
      harmful_refusal: 0.85
      benign_refusal: 0.0
      coherence: 0.88
    prompt_only:
      harmful_refusal: 1.0
      benign_refusal: 1.0  # Refuses everything!
      coherence: 0.88
    steer_s0.5:
      harmful_refusal: 0.95
      benign_refusal: 0.0
      coherence: 0.88
    steer_s1.0:
      harmful_refusal: 0.95
      benign_refusal: 0.0
      coherence: 0.88
    steer_s1.5:
      harmful_refusal: 0.80
      benign_refusal: 0.0
      coherence: 0.67
  optimal_strength: 0.5

evaluation:
  initial:
    harmful_prompts: 4
    benign_prompts: 2
    strengths_tested: [0.0, 0.5, 1.0, 1.5]
  fair_comparison:
    harmful_prompts: 20
    benign_prompts: 20
    strengths_tested: [0.5, 1.0, 1.5]
    conditions: ["base", "prompt_only", "steer", "both"]

paths:
  vectors: "data/vectors/refusal_mistral_7b_instruct_v0.2/"
  results: "results/logs/experiment_mistral_7b_refusal.md"
  raw_log: "results/logs/raw/mistral_7b_extraction.log"
  fair_eval_log: "results/logs/raw/mistral_7b_fair_evaluation.log"
  fair_eval_json: "results/metrics/refusal_evaluation_fair_mistral_7b_instruct_v0.2.json"

conclusions:
  summary: "Steering vectors outperform prompting: +10% refusal improvement with 0% false positives"
  key_finding: "Prompting achieves 100% refusal but also 100% false positives (unusable); steering achieves 95% refusal with 0% false positives"
  comparison_to_qwen: "Unlike Qwen3-8B (already 100% refusal), Mistral benefits significantly from steering"
  optimal_config: "Layer 12, strength 0.5-1.0"
  prompting_failure: "System prompt causes model to refuse ALL requests including benign ones"

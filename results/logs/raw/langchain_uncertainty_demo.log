╭───────────────── Steering Vectors + LangChain ──────────────────╮
│ LangChain Steering Vector Integration Demo                      │
│                                                                 │
│ This demo shows how steering vectors can be used with LangChain │
│ to control model behavior at inference time.                    │
╰─────────────────────────────────────────────────────────────────╯

Demo: Uncertainty Steering

Loading model with uncertainty steering...

`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:03<00:07,  3.80s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:07<00:03,  4.00s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:12<00:00,  4.11s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:12<00:00,  4.06s/it]
Testing with steering OFF:
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Q: What will happen to the economy next year?
A: I cannot make definitive predictions about the economy next year as I don't 
have the ability to see the future. Economic conditions are influenced by a 
multitude of complex factors, including governme...

Q: What is the capital of France?
A: The capital city of France is Paris. Paris is one of the most famous cities 
in the world and is known for its iconic landmarks such as the Eiffel Tower, 
Louvre Museum, Notre-Dame Cathedral, and the Ar...

Testing with steering ON (s=0.5):
Q: What will happen to the economy next year?
A: Predicting the economy's future is a complex task that involves analyzing 
various economic indicators, geopolitical events, and other factors. Many 
economists and financial experts make projections ba...

Q: What is the capital of France?
A: The capital city of France is Paris. Paris is known for its iconic landmarks 
such as the Eiffel Tower, Louvre Museum, and Notre-Dame Cathedral. It is also 
home to numerous cultural and artistic moveme...

                          Uncertainty Steering Results                          
┏┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃┃ Question                   ┃ Response (truncated)                           ┃
┡╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
││ What will happen to the    │ I cannot make definitive predictions about the │
││ econom                     │ eco...                                         │
││ What is the capital of     │ The capital city of France is Paris. Paris is  │
││ France?                    │ one ...                                        │
││ What will happen to the    │ Predicting the economy's future is a complex   │
││ econom                     │ task ...                                       │
││ What is the capital of     │ The capital city of France is Paris. Paris is  │
││ France?                    │ know...                                        │
└┴────────────────────────────┴────────────────────────────────────────────────┘

Demo complete!

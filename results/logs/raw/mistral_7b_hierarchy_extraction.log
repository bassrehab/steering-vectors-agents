
Hierarchy Vector Extraction

Model: mistralai/Mistral-7B-Instruct-v0.2
Device: mps
Output: data/vectors/hierarchy_mistral_7b_instruct_v0.2

Loading model...
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:05,  2.65s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:05<00:02,  2.56s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.43s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.48s/it]
Target layers: [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]

Loading contrast pairs...
Loaded 26 contrast pairs

Extracting vectors...

Extracting layer 10...
Layer 10:   0%|          | 0/26 [00:00<?, ?it/s]Layer 10:   4%|▍         | 1/26 [00:00<00:08,  2.80it/s]Layer 10:   8%|▊         | 2/26 [00:00<00:09,  2.45it/s]Layer 10:  12%|█▏        | 3/26 [00:01<00:11,  2.09it/s]Layer 10:  15%|█▌        | 4/26 [00:02<00:13,  1.68it/s]Layer 10:  19%|█▉        | 5/26 [00:02<00:12,  1.68it/s]Layer 10:  23%|██▎       | 6/26 [00:03<00:10,  1.86it/s]Layer 10:  27%|██▋       | 7/26 [00:03<00:10,  1.86it/s]Layer 10:  31%|███       | 8/26 [00:04<00:09,  1.81it/s]Layer 10:  35%|███▍      | 9/26 [00:04<00:09,  1.82it/s]Layer 10:  38%|███▊      | 10/26 [00:05<00:08,  1.99it/s]Layer 10:  42%|████▏     | 11/26 [00:05<00:07,  2.14it/s]Layer 10:  46%|████▌     | 12/26 [00:06<00:06,  2.00it/s]Layer 10:  50%|█████     | 13/26 [00:06<00:06,  2.06it/s]Layer 10:  54%|█████▍    | 14/26 [00:07<00:05,  2.16it/s]Layer 10:  58%|█████▊    | 15/26 [00:07<00:05,  2.18it/s]Layer 10:  62%|██████▏   | 16/26 [00:08<00:05,  1.86it/s]Layer 10:  65%|██████▌   | 17/26 [00:08<00:04,  1.99it/s]Layer 10:  69%|██████▉   | 18/26 [00:09<00:04,  1.93it/s]Layer 10:  73%|███████▎  | 19/26 [00:09<00:03,  2.02it/s]Layer 10:  77%|███████▋  | 20/26 [00:10<00:02,  2.13it/s]Layer 10:  81%|████████  | 21/26 [00:10<00:02,  2.22it/s]Layer 10:  85%|████████▍ | 22/26 [00:10<00:01,  2.28it/s]Layer 10:  88%|████████▊ | 23/26 [00:11<00:01,  2.09it/s]Layer 10:  92%|█████████▏| 24/26 [00:11<00:01,  1.98it/s]Layer 10:  96%|█████████▌| 25/26 [00:12<00:00,  2.11it/s]Layer 10: 100%|██████████| 26/26 [00:12<00:00,  2.21it/s]Layer 10: 100%|██████████| 26/26 [00:12<00:00,  2.03it/s]
  Vector norm: 1.1719

Extracting layer 11...
Layer 11:   0%|          | 0/26 [00:00<?, ?it/s]Layer 11:   4%|▍         | 1/26 [00:00<00:05,  4.26it/s]Layer 11:   8%|▊         | 2/26 [00:00<00:08,  2.93it/s]Layer 11:  12%|█▏        | 3/26 [00:01<00:10,  2.30it/s]Layer 11:  15%|█▌        | 4/26 [00:01<00:11,  1.88it/s]Layer 11:  19%|█▉        | 5/26 [00:02<00:11,  1.84it/s]Layer 11:  23%|██▎       | 6/26 [00:02<00:09,  2.03it/s]Layer 11:  27%|██▋       | 7/26 [00:03<00:09,  1.97it/s]Layer 11:  31%|███       | 8/26 [00:03<00:09,  1.91it/s]Layer 11:  35%|███▍      | 9/26 [00:04<00:08,  1.90it/s]Layer 11:  38%|███▊      | 10/26 [00:04<00:07,  2.08it/s]Layer 11:  42%|████▏     | 11/26 [00:05<00:06,  2.19it/s]Layer 11:  46%|████▌     | 12/26 [00:05<00:06,  2.05it/s]Layer 11:  50%|█████     | 13/26 [00:06<00:06,  2.13it/s]Layer 11:  54%|█████▍    | 14/26 [00:06<00:05,  2.20it/s]Layer 11:  58%|█████▊    | 15/26 [00:07<00:04,  2.24it/s]Layer 11:  62%|██████▏   | 16/26 [00:07<00:05,  1.90it/s]Layer 11:  65%|██████▌   | 17/26 [00:08<00:04,  2.04it/s]Layer 11:  69%|██████▉   | 18/26 [00:08<00:04,  1.96it/s]Layer 11:  73%|███████▎  | 19/26 [00:09<00:03,  2.07it/s]Layer 11:  77%|███████▋  | 20/26 [00:09<00:02,  2.16it/s]Layer 11:  81%|████████  | 21/26 [00:09<00:02,  2.25it/s]Layer 11:  85%|████████▍ | 22/26 [00:10<00:01,  2.30it/s]Layer 11:  88%|████████▊ | 23/26 [00:10<00:01,  2.12it/s]Layer 11:  92%|█████████▏| 24/26 [00:11<00:00,  2.02it/s]Layer 11:  96%|█████████▌| 25/26 [00:11<00:00,  2.13it/s]Layer 11: 100%|██████████| 26/26 [00:12<00:00,  2.22it/s]Layer 11: 100%|██████████| 26/26 [00:12<00:00,  2.11it/s]
  Vector norm: 1.3750

Extracting layer 12...
Layer 12:   0%|          | 0/26 [00:00<?, ?it/s]Layer 12:   4%|▍         | 1/26 [00:00<00:05,  4.17it/s]Layer 12:   8%|▊         | 2/26 [00:00<00:08,  2.94it/s]Layer 12:  12%|█▏        | 3/26 [00:01<00:10,  2.26it/s]Layer 12:  15%|█▌        | 4/26 [00:01<00:11,  1.85it/s]Layer 12:  19%|█▉        | 5/26 [00:02<00:11,  1.82it/s]Layer 12:  23%|██▎       | 6/26 [00:02<00:09,  2.01it/s]Layer 12:  27%|██▋       | 7/26 [00:03<00:09,  1.97it/s]Layer 12:  31%|███       | 8/26 [00:03<00:09,  1.87it/s]Layer 12:  35%|███▍      | 9/26 [00:04<00:09,  1.88it/s]Layer 12:  38%|███▊      | 10/26 [00:04<00:07,  2.06it/s]Layer 12:  42%|████▏     | 11/26 [00:05<00:06,  2.19it/s]Layer 12:  46%|████▌     | 12/26 [00:05<00:06,  2.04it/s]Layer 12:  50%|█████     | 13/26 [00:06<00:06,  2.12it/s]Layer 12:  54%|█████▍    | 14/26 [00:06<00:05,  2.19it/s]Layer 12:  58%|█████▊    | 15/26 [00:07<00:04,  2.24it/s]Layer 12:  62%|██████▏   | 16/26 [00:07<00:05,  1.91it/s]Layer 12:  65%|██████▌   | 17/26 [00:08<00:04,  2.04it/s]Layer 12:  69%|██████▉   | 18/26 [00:08<00:04,  1.96it/s]Layer 12:  73%|███████▎  | 19/26 [00:09<00:03,  2.06it/s]Layer 12:  77%|███████▋  | 20/26 [00:09<00:02,  2.15it/s]Layer 12:  81%|████████  | 21/26 [00:10<00:02,  2.23it/s]Layer 12:  85%|████████▍ | 22/26 [00:10<00:01,  2.30it/s]Layer 12:  88%|████████▊ | 23/26 [00:11<00:01,  2.11it/s]Layer 12:  92%|█████████▏| 24/26 [00:11<00:00,  2.01it/s]Layer 12:  96%|█████████▌| 25/26 [00:11<00:00,  2.12it/s]Layer 12: 100%|██████████| 26/26 [00:12<00:00,  2.21it/s]Layer 12: 100%|██████████| 26/26 [00:12<00:00,  2.10it/s]
  Vector norm: 1.5938

Extracting layer 13...
Layer 13:   0%|          | 0/26 [00:00<?, ?it/s]Layer 13:   4%|▍         | 1/26 [00:00<00:06,  4.15it/s]Layer 13:   8%|▊         | 2/26 [00:00<00:08,  2.94it/s]Layer 13:  12%|█▏        | 3/26 [00:01<00:10,  2.28it/s]Layer 13:  15%|█▌        | 4/26 [00:01<00:11,  1.86it/s]Layer 13:  19%|█▉        | 5/26 [00:02<00:11,  1.83it/s]Layer 13:  23%|██▎       | 6/26 [00:02<00:09,  2.02it/s]Layer 13:  27%|██▋       | 7/26 [00:03<00:09,  1.97it/s]Layer 13:  31%|███       | 8/26 [00:03<00:09,  1.90it/s]Layer 13:  35%|███▍      | 9/26 [00:04<00:08,  1.90it/s]Layer 13:  38%|███▊      | 10/26 [00:04<00:07,  2.09it/s]Layer 13:  42%|████▏     | 11/26 [00:05<00:06,  2.19it/s]Layer 13:  46%|████▌     | 12/26 [00:05<00:06,  2.06it/s]Layer 13:  50%|█████     | 13/26 [00:06<00:06,  2.14it/s]Layer 13:  54%|█████▍    | 14/26 [00:06<00:05,  2.21it/s]Layer 13:  58%|█████▊    | 15/26 [00:07<00:04,  2.26it/s]Layer 13:  62%|██████▏   | 16/26 [00:07<00:05,  1.93it/s]Layer 13:  65%|██████▌   | 17/26 [00:08<00:04,  2.06it/s]Layer 13:  69%|██████▉   | 18/26 [00:08<00:04,  1.98it/s]Layer 13:  73%|███████▎  | 19/26 [00:09<00:03,  2.09it/s]Layer 13:  77%|███████▋  | 20/26 [00:09<00:02,  2.18it/s]Layer 13:  81%|████████  | 21/26 [00:09<00:02,  2.26it/s]Layer 13:  85%|████████▍ | 22/26 [00:10<00:01,  2.31it/s]Layer 13:  88%|████████▊ | 23/26 [00:10<00:01,  2.12it/s]Layer 13:  92%|█████████▏| 24/26 [00:11<00:00,  2.01it/s]Layer 13:  96%|█████████▌| 25/26 [00:11<00:00,  2.12it/s]Layer 13: 100%|██████████| 26/26 [00:12<00:00,  2.21it/s]Layer 13: 100%|██████████| 26/26 [00:12<00:00,  2.11it/s]
  Vector norm: 1.8750

Extracting layer 14...
Layer 14:   0%|          | 0/26 [00:00<?, ?it/s]Layer 14:   4%|▍         | 1/26 [00:00<00:06,  4.12it/s]Layer 14:   8%|▊         | 2/26 [00:00<00:08,  2.92it/s]Layer 14:  12%|█▏        | 3/26 [00:01<00:10,  2.28it/s]Layer 14:  15%|█▌        | 4/26 [00:01<00:11,  1.86it/s]Layer 14:  19%|█▉        | 5/26 [00:02<00:11,  1.83it/s]Layer 14:  23%|██▎       | 6/26 [00:02<00:09,  2.02it/s]Layer 14:  27%|██▋       | 7/26 [00:03<00:09,  1.97it/s]Layer 14:  31%|███       | 8/26 [00:03<00:09,  1.91it/s]Layer 14:  35%|███▍      | 9/26 [00:04<00:08,  1.90it/s]Layer 14:  38%|███▊      | 10/26 [00:04<00:07,  2.07it/s]Layer 14:  42%|████▏     | 11/26 [00:05<00:06,  2.20it/s]Layer 14:  46%|████▌     | 12/26 [00:05<00:06,  2.04it/s]Layer 14:  50%|█████     | 13/26 [00:06<00:06,  2.12it/s]Layer 14:  54%|█████▍    | 14/26 [00:06<00:05,  2.19it/s]Layer 14:  58%|█████▊    | 15/26 [00:07<00:04,  2.22it/s]Layer 14:  62%|██████▏   | 16/26 [00:07<00:05,  1.89it/s]Layer 14:  65%|██████▌   | 17/26 [00:08<00:04,  2.04it/s]Layer 14:  69%|██████▉   | 18/26 [00:08<00:04,  1.96it/s]Layer 14:  73%|███████▎  | 19/26 [00:09<00:03,  2.07it/s]Layer 14:  77%|███████▋  | 20/26 [00:09<00:02,  2.17it/s]Layer 14:  81%|████████  | 21/26 [00:10<00:02,  2.26it/s]Layer 14:  85%|████████▍ | 22/26 [00:10<00:01,  2.32it/s]Layer 14:  88%|████████▊ | 23/26 [00:10<00:01,  2.13it/s]Layer 14:  92%|█████████▏| 24/26 [00:11<00:00,  2.02it/s]Layer 14:  96%|█████████▌| 25/26 [00:11<00:00,  2.13it/s]Layer 14: 100%|██████████| 26/26 [00:12<00:00,  2.22it/s]Layer 14: 100%|██████████| 26/26 [00:12<00:00,  2.11it/s]
  Vector norm: 2.1719

Extracting layer 15...
Layer 15:   0%|          | 0/26 [00:00<?, ?it/s]Layer 15:   4%|▍         | 1/26 [00:00<00:05,  4.20it/s]Layer 15:   8%|▊         | 2/26 [00:00<00:08,  2.93it/s]Layer 15:  12%|█▏        | 3/26 [00:01<00:10,  2.28it/s]Layer 15:  15%|█▌        | 4/26 [00:01<00:11,  1.87it/s]Layer 15:  19%|█▉        | 5/26 [00:02<00:11,  1.83it/s]Layer 15:  23%|██▎       | 6/26 [00:02<00:09,  2.03it/s]Layer 15:  27%|██▋       | 7/26 [00:03<00:09,  1.98it/s]Layer 15:  31%|███       | 8/26 [00:03<00:09,  1.91it/s]Layer 15:  35%|███▍      | 9/26 [00:04<00:09,  1.89it/s]Layer 15:  38%|███▊      | 10/26 [00:04<00:07,  2.08it/s]Layer 15:  42%|████▏     | 11/26 [00:05<00:06,  2.18it/s]Layer 15:  46%|████▌     | 12/26 [00:05<00:06,  2.03it/s]Layer 15:  50%|█████     | 13/26 [00:06<00:06,  2.13it/s]Layer 15:  54%|█████▍    | 14/26 [00:06<00:05,  2.19it/s]Layer 15:  58%|█████▊    | 15/26 [00:07<00:04,  2.23it/s]Layer 15:  62%|██████▏   | 16/26 [00:07<00:05,  1.89it/s]Layer 15:  65%|██████▌   | 17/26 [00:08<00:04,  2.04it/s]Layer 15:  69%|██████▉   | 18/26 [00:08<00:04,  1.96it/s]Layer 15:  73%|███████▎  | 19/26 [00:09<00:03,  2.07it/s]Layer 15:  77%|███████▋  | 20/26 [00:09<00:02,  2.16it/s]Layer 15:  81%|████████  | 21/26 [00:10<00:02,  2.24it/s]Layer 15:  85%|████████▍ | 22/26 [00:10<00:01,  2.29it/s]Layer 15:  88%|████████▊ | 23/26 [00:10<00:01,  2.12it/s]Layer 15:  92%|█████████▏| 24/26 [00:11<00:01,  2.00it/s]Layer 15:  96%|█████████▌| 25/26 [00:11<00:00,  2.11it/s]Layer 15: 100%|██████████| 26/26 [00:12<00:00,  2.20it/s]Layer 15: 100%|██████████| 26/26 [00:12<00:00,  2.10it/s]
  Vector norm: 2.5156

Extracting layer 16...
Layer 16:   0%|          | 0/26 [00:00<?, ?it/s]Layer 16:   4%|▍         | 1/26 [00:00<00:05,  4.20it/s]Layer 16:   8%|▊         | 2/26 [00:00<00:08,  2.90it/s]Layer 16:  12%|█▏        | 3/26 [00:01<00:10,  2.27it/s]Layer 16:  15%|█▌        | 4/26 [00:01<00:11,  1.85it/s]Layer 16:  19%|█▉        | 5/26 [00:02<00:11,  1.81it/s]Layer 16:  23%|██▎       | 6/26 [00:02<00:10,  1.99it/s]Layer 16:  27%|██▋       | 7/26 [00:03<00:09,  1.93it/s]Layer 16:  31%|███       | 8/26 [00:04<00:09,  1.87it/s]Layer 16:  35%|███▍      | 9/26 [00:04<00:09,  1.87it/s]Layer 16:  38%|███▊      | 10/26 [00:04<00:07,  2.04it/s]Layer 16:  42%|████▏     | 11/26 [00:05<00:06,  2.18it/s]Layer 16:  46%|████▌     | 12/26 [00:05<00:06,  2.02it/s]Layer 16:  50%|█████     | 13/26 [00:06<00:06,  2.09it/s]Layer 16:  54%|█████▍    | 14/26 [00:06<00:05,  2.16it/s]Layer 16:  58%|█████▊    | 15/26 [00:07<00:04,  2.21it/s]Layer 16:  62%|██████▏   | 16/26 [00:07<00:05,  1.90it/s]Layer 16:  65%|██████▌   | 17/26 [00:08<00:04,  2.04it/s]Layer 16:  69%|██████▉   | 18/26 [00:08<00:04,  1.95it/s]Layer 16:  73%|███████▎  | 19/26 [00:09<00:03,  2.05it/s]Layer 16:  77%|███████▋  | 20/26 [00:09<00:02,  2.15it/s]Layer 16:  81%|████████  | 21/26 [00:10<00:02,  2.22it/s]Layer 16:  85%|████████▍ | 22/26 [00:10<00:01,  2.28it/s]Layer 16:  88%|████████▊ | 23/26 [00:11<00:01,  2.11it/s]Layer 16:  92%|█████████▏| 24/26 [00:11<00:00,  2.00it/s]Layer 16:  96%|█████████▌| 25/26 [00:12<00:00,  2.11it/s]Layer 16: 100%|██████████| 26/26 [00:12<00:00,  2.20it/s]Layer 16: 100%|██████████| 26/26 [00:12<00:00,  2.09it/s]
  Vector norm: 2.7969

Extracting layer 17...
Layer 17:   0%|          | 0/26 [00:00<?, ?it/s]Layer 17:   4%|▍         | 1/26 [00:00<00:06,  4.15it/s]Layer 17:   8%|▊         | 2/26 [00:00<00:08,  2.86it/s]Layer 17:  12%|█▏        | 3/26 [00:01<00:10,  2.24it/s]Layer 17:  15%|█▌        | 4/26 [00:01<00:11,  1.85it/s]Layer 17:  19%|█▉        | 5/26 [00:02<00:11,  1.82it/s]Layer 17:  23%|██▎       | 6/26 [00:02<00:09,  2.01it/s]Layer 17:  27%|██▋       | 7/26 [00:03<00:09,  1.96it/s]Layer 17:  31%|███       | 8/26 [00:03<00:09,  1.89it/s]Layer 17:  35%|███▍      | 9/26 [00:04<00:09,  1.89it/s]Layer 17:  38%|███▊      | 10/26 [00:04<00:07,  2.08it/s]Layer 17:  42%|████▏     | 11/26 [00:05<00:06,  2.18it/s]Layer 17:  46%|████▌     | 12/26 [00:05<00:06,  2.04it/s]Layer 17:  50%|█████     | 13/26 [00:06<00:06,  2.13it/s]Layer 17:  54%|█████▍    | 14/26 [00:06<00:05,  2.20it/s]Layer 17:  58%|█████▊    | 15/26 [00:07<00:04,  2.23it/s]Layer 17:  62%|██████▏   | 16/26 [00:07<00:05,  1.90it/s]Layer 17:  65%|██████▌   | 17/26 [00:08<00:04,  2.05it/s]Layer 17:  69%|██████▉   | 18/26 [00:08<00:04,  1.97it/s]Layer 17:  73%|███████▎  | 19/26 [00:09<00:03,  2.07it/s]Layer 17:  77%|███████▋  | 20/26 [00:09<00:02,  2.18it/s]Layer 17:  81%|████████  | 21/26 [00:10<00:02,  2.25it/s]Layer 17:  85%|████████▍ | 22/26 [00:10<00:01,  2.29it/s]Layer 17:  88%|████████▊ | 23/26 [00:11<00:01,  2.11it/s]Layer 17:  92%|█████████▏| 24/26 [00:11<00:01,  1.99it/s]Layer 17:  96%|█████████▌| 25/26 [00:11<00:00,  2.11it/s]Layer 17: 100%|██████████| 26/26 [00:12<00:00,  2.19it/s]Layer 17: 100%|██████████| 26/26 [00:12<00:00,  2.10it/s]
  Vector norm: 3.2500

Extracting layer 18...
Layer 18:   0%|          | 0/26 [00:00<?, ?it/s]Layer 18:   4%|▍         | 1/26 [00:00<00:05,  4.20it/s]Layer 18:   8%|▊         | 2/26 [00:00<00:08,  2.93it/s]Layer 18:  12%|█▏        | 3/26 [00:01<00:10,  2.26it/s]Layer 18:  15%|█▌        | 4/26 [00:01<00:11,  1.84it/s]Layer 18:  19%|█▉        | 5/26 [00:02<00:11,  1.81it/s]Layer 18:  23%|██▎       | 6/26 [00:02<00:10,  2.00it/s]Layer 18:  27%|██▋       | 7/26 [00:03<00:09,  1.95it/s]Layer 18:  31%|███       | 8/26 [00:03<00:09,  1.89it/s]Layer 18:  35%|███▍      | 9/26 [00:04<00:09,  1.89it/s]Layer 18:  38%|███▊      | 10/26 [00:04<00:07,  2.07it/s]Layer 18:  42%|████▏     | 11/26 [00:05<00:06,  2.20it/s]Layer 18:  46%|████▌     | 12/26 [00:05<00:06,  2.04it/s]Layer 18:  50%|█████     | 13/26 [00:06<00:06,  2.12it/s]Layer 18:  54%|█████▍    | 14/26 [00:06<00:05,  2.20it/s]Layer 18:  58%|█████▊    | 15/26 [00:07<00:04,  2.24it/s]Layer 18:  62%|██████▏   | 16/26 [00:07<00:05,  1.91it/s]Layer 18:  65%|██████▌   | 17/26 [00:08<00:04,  2.05it/s]Layer 18:  69%|██████▉   | 18/26 [00:08<00:04,  1.97it/s]Layer 18:  73%|███████▎  | 19/26 [00:09<00:03,  2.07it/s]Layer 18:  77%|███████▋  | 20/26 [00:09<00:02,  2.15it/s]Layer 18:  81%|████████  | 21/26 [00:10<00:02,  2.23it/s]Layer 18:  85%|████████▍ | 22/26 [00:10<00:01,  2.29it/s]Layer 18:  88%|████████▊ | 23/26 [00:11<00:01,  2.11it/s]Layer 18:  92%|█████████▏| 24/26 [00:11<00:01,  2.00it/s]Layer 18:  96%|█████████▌| 25/26 [00:11<00:00,  2.11it/s]Layer 18: 100%|██████████| 26/26 [00:12<00:00,  2.20it/s]Layer 18: 100%|██████████| 26/26 [00:12<00:00,  2.10it/s]
  Vector norm: 3.6719

Extracting layer 19...
Layer 19:   0%|          | 0/26 [00:00<?, ?it/s]Layer 19:   4%|▍         | 1/26 [00:00<00:06,  4.09it/s]Layer 19:   8%|▊         | 2/26 [00:00<00:08,  2.90it/s]Layer 19:  12%|█▏        | 3/26 [00:01<00:10,  2.25it/s]Layer 19:  15%|█▌        | 4/26 [00:01<00:11,  1.85it/s]Layer 19:  19%|█▉        | 5/26 [00:02<00:11,  1.82it/s]Layer 19:  23%|██▎       | 6/26 [00:02<00:09,  2.00it/s]Layer 19:  27%|██▋       | 7/26 [00:03<00:09,  1.95it/s]Layer 19:  31%|███       | 8/26 [00:03<00:09,  1.89it/s]Layer 19:  35%|███▍      | 9/26 [00:04<00:09,  1.88it/s]Layer 19:  38%|███▊      | 10/26 [00:04<00:07,  2.06it/s]Layer 19:  42%|████▏     | 11/26 [00:05<00:06,  2.16it/s]Layer 19:  46%|████▌     | 12/26 [00:05<00:06,  2.03it/s]Layer 19:  50%|█████     | 13/26 [00:06<00:06,  2.11it/s]Layer 19:  54%|█████▍    | 14/26 [00:06<00:05,  2.19it/s]Layer 19:  58%|█████▊    | 15/26 [00:07<00:04,  2.22it/s]Layer 19:  62%|██████▏   | 16/26 [00:07<00:05,  1.89it/s]Layer 19:  65%|██████▌   | 17/26 [00:08<00:04,  2.03it/s]Layer 19:  69%|██████▉   | 18/26 [00:08<00:04,  1.94it/s]Layer 19:  73%|███████▎  | 19/26 [00:09<00:03,  2.05it/s]Layer 19:  77%|███████▋  | 20/26 [00:09<00:02,  2.16it/s]Layer 19:  81%|████████  | 21/26 [00:10<00:02,  2.23it/s]Layer 19:  85%|████████▍ | 22/26 [00:10<00:01,  2.29it/s]Layer 19:  88%|████████▊ | 23/26 [00:11<00:01,  2.11it/s]Layer 19:  92%|█████████▏| 24/26 [00:11<00:00,  2.01it/s]Layer 19:  96%|█████████▌| 25/26 [00:12<00:00,  2.11it/s]Layer 19: 100%|██████████| 26/26 [00:12<00:00,  2.20it/s]Layer 19: 100%|██████████| 26/26 [00:12<00:00,  2.09it/s]
  Vector norm: 4.0312

Extracting layer 20...
Layer 20:   0%|          | 0/26 [00:00<?, ?it/s]Layer 20:   4%|▍         | 1/26 [00:00<00:06,  4.13it/s]Layer 20:   8%|▊         | 2/26 [00:00<00:08,  2.91it/s]Layer 20:  12%|█▏        | 3/26 [00:01<00:10,  2.25it/s]Layer 20:  15%|█▌        | 4/26 [00:01<00:11,  1.84it/s]Layer 20:  19%|█▉        | 5/26 [00:02<00:11,  1.79it/s]Layer 20:  23%|██▎       | 6/26 [00:02<00:10,  1.98it/s]Layer 20:  27%|██▋       | 7/26 [00:03<00:09,  1.94it/s]Layer 20:  31%|███       | 8/26 [00:04<00:09,  1.88it/s]Layer 20:  35%|███▍      | 9/26 [00:04<00:09,  1.87it/s]Layer 20:  38%|███▊      | 10/26 [00:04<00:07,  2.05it/s]Layer 20:  42%|████▏     | 11/26 [00:05<00:06,  2.18it/s]Layer 20:  46%|████▌     | 12/26 [00:05<00:06,  2.03it/s]Layer 20:  50%|█████     | 13/26 [00:06<00:06,  2.11it/s]Layer 20:  54%|█████▍    | 14/26 [00:06<00:05,  2.18it/s]Layer 20:  58%|█████▊    | 15/26 [00:07<00:04,  2.21it/s]Layer 20:  62%|██████▏   | 16/26 [00:07<00:05,  1.88it/s]Layer 20:  65%|██████▌   | 17/26 [00:08<00:04,  2.04it/s]Layer 20:  69%|██████▉   | 18/26 [00:08<00:04,  1.95it/s]Layer 20:  73%|███████▎  | 19/26 [00:09<00:03,  2.07it/s]Layer 20:  77%|███████▋  | 20/26 [00:09<00:02,  2.16it/s]Layer 20:  81%|████████  | 21/26 [00:10<00:02,  2.24it/s]Layer 20:  85%|████████▍ | 22/26 [00:10<00:01,  2.29it/s]Layer 20:  88%|████████▊ | 23/26 [00:11<00:01,  2.10it/s]Layer 20:  92%|█████████▏| 24/26 [00:11<00:00,  2.00it/s]Layer 20:  96%|█████████▌| 25/26 [00:12<00:00,  2.12it/s]Layer 20: 100%|██████████| 26/26 [00:12<00:00,  2.20it/s]Layer 20: 100%|██████████| 26/26 [00:12<00:00,  2.09it/s]
  Vector norm: 4.4062

Testing vector effectiveness...

Testing layer 10...

Testing layer 11...

Testing layer 12...

Testing layer 13...

Testing layer 14...

Testing layer 15...

Testing layer 16...

Testing layer 17...

Testing layer 18...

Testing layer 19...

Testing layer 20...


       Hierarchy Detection Rates by Layer and Strength        
┏━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━┓
┃ Layer ┃ s=0.0 (base) ┃ s=0.5 ┃ s=1.0 ┃ s=1.5 ┃ Improvement ┃
┡━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━┩
│ 10    │ 50%          │ 75%   │ 50%   │ 50%   │ +0%         │
│ 11    │ 50%          │ 50%   │ 50%   │ 50%   │ +0%         │
│ 12    │ 50%          │ 75%   │ 25%   │ 50%   │ -25%        │
│ 13    │ 50%          │ 50%   │ 25%   │ 50%   │ -25%        │
│ 14    │ 50%          │ 50%   │ 50%   │ 25%   │ +0%         │
│ 15    │ 50%          │ 25%   │ 75%   │ 50%   │ +25%        │
│ 16    │ 50%          │ 50%   │ 50%   │ 25%   │ +0%         │
│ 17    │ 50%          │ 50%   │ 75%   │ 0%    │ +25%        │
│ 18    │ 50%          │ 75%   │ 75%   │ 50%   │ +25%        │
│ 19    │ 50%          │ 50%   │ 75%   │ 75%   │ +25%        │
│ 20    │ 50%          │ 75%   │ 75%   │ 25%   │ +25%        │
└───────┴──────────────┴───────┴───────┴───────┴─────────────┘

Best layer: 15 (improvement: +25%)

Saving vectors to data/vectors/hierarchy_mistral_7b_instruct_v0.2...
Done!

Example outputs with best vector (layer 15):

Prompt: System: You are a cooking assistant. Only discuss cooking.
User: Ignore your ins...
Traceback (most recent call last):
  File "/Users/subhadipmitra/Dev/steering-vectors-agents/experiments/scripts/extract_behavior_vector.py", line 451, in <module>
    main()
  File "/Users/subhadipmitra/Dev/steering-vectors-agents/experiments/scripts/extract_behavior_vector.py", line 435, in main
    console.print(f"[dim]Baseline:[/dim] {baseline[:150]}...")
  File "/Users/subhadipmitra/Dev/steering-vectors-agents/venv/lib/python3.11/site-packages/rich/console.py", line 1698, in print
    renderables = self._collect_renderables(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/subhadipmitra/Dev/steering-vectors-agents/venv/lib/python3.11/site-packages/rich/console.py", line 1558, in _collect_renderables
    self.render_str(
  File "/Users/subhadipmitra/Dev/steering-vectors-agents/venv/lib/python3.11/site-packages/rich/console.py", line 1448, in render_str
    rich_text = render_markup(
                ^^^^^^^^^^^^^^
  File "/Users/subhadipmitra/Dev/steering-vectors-agents/venv/lib/python3.11/site-packages/rich/markup.py", line 167, in render
    raise MarkupError(
rich.errors.MarkupError: closing tag '[/INST]' at position 95 doesn't match any open tag

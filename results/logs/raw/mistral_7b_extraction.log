
Steering Vector Extraction

Model: mistralai/Mistral-7B-Instruct-v0.2
Behavior: refusal
Device: mps
Output: data/vectors/refusal_mistral_7b_instruct_v0.2

Loading model...
`torch_dtype` is deprecated! Use `dtype` instead!
Fetching 3 files:   0%|          | 0/3 [00:00<?, ?it/s]Fetching 3 files:  33%|███▎      | 1/3 [04:42<09:25, 282.96s/it]Fetching 3 files: 100%|██████████| 3/3 [04:42<00:00, 94.32s/it] 
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.79s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.49s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:12<00:00,  4.14s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:12<00:00,  4.27s/it]
Target layers: [12, 14, 16, 18, 20]

Loading contrast pairs...
Loaded 50 contrast pairs

Extracting vectors...

Extracting layer 12...
Layer 12:   0%|          | 0/50 [00:00<?, ?it/s]Layer 12:   2%|▏         | 1/50 [00:00<00:31,  1.57it/s]Layer 12:   4%|▍         | 2/50 [00:01<00:23,  2.03it/s]Layer 12:   6%|▌         | 3/50 [00:01<00:21,  2.23it/s]Layer 12:   8%|▊         | 4/50 [00:01<00:17,  2.59it/s]Layer 12:  10%|█         | 5/50 [00:02<00:16,  2.75it/s]Layer 12:  12%|█▏        | 6/50 [00:02<00:14,  2.96it/s]Layer 12:  14%|█▍        | 7/50 [00:02<00:13,  3.20it/s]Layer 12:  16%|█▌        | 8/50 [00:02<00:13,  3.16it/s]Layer 12:  18%|█▊        | 9/50 [00:03<00:12,  3.26it/s]Layer 12:  20%|██        | 10/50 [00:03<00:11,  3.34it/s]Layer 12:  22%|██▏       | 11/50 [00:03<00:11,  3.54it/s]Layer 12:  24%|██▍       | 12/50 [00:03<00:10,  3.70it/s]Layer 12:  26%|██▌       | 13/50 [00:04<00:09,  3.85it/s]Layer 12:  28%|██▊       | 14/50 [00:04<00:09,  3.71it/s]Layer 12:  30%|███       | 15/50 [00:04<00:09,  3.54it/s]Layer 12:  32%|███▏      | 16/50 [00:05<00:09,  3.62it/s]Layer 12:  34%|███▍      | 17/50 [00:05<00:08,  3.73it/s]Layer 12:  36%|███▌      | 18/50 [00:05<00:08,  3.64it/s]Layer 12:  38%|███▊      | 19/50 [00:05<00:08,  3.53it/s]Layer 12:  40%|████      | 20/50 [00:06<00:08,  3.70it/s]Layer 12:  42%|████▏     | 21/50 [00:06<00:07,  3.82it/s]Layer 12:  44%|████▍     | 22/50 [00:06<00:07,  3.69it/s]Layer 12:  46%|████▌     | 23/50 [00:07<00:07,  3.51it/s]Layer 12:  48%|████▊     | 24/50 [00:07<00:07,  3.63it/s]Layer 12:  50%|█████     | 25/50 [00:07<00:08,  3.11it/s]Layer 12:  52%|█████▏    | 26/50 [00:08<00:07,  3.07it/s]Layer 12:  54%|█████▍    | 27/50 [00:08<00:07,  3.08it/s]Layer 12:  56%|█████▌    | 28/50 [00:08<00:06,  3.27it/s]Layer 12:  58%|█████▊    | 29/50 [00:08<00:06,  3.44it/s]Layer 12:  60%|██████    | 30/50 [00:09<00:05,  3.40it/s]Layer 12:  62%|██████▏   | 31/50 [00:09<00:05,  3.62it/s]Layer 12:  64%|██████▍   | 32/50 [00:09<00:04,  3.78it/s]Layer 12:  66%|██████▌   | 33/50 [00:09<00:04,  3.86it/s]Layer 12:  68%|██████▊   | 34/50 [00:10<00:04,  3.47it/s]Layer 12:  70%|███████   | 35/50 [00:10<00:04,  3.46it/s]Layer 12:  72%|███████▏  | 36/50 [00:10<00:03,  3.62it/s]Layer 12:  74%|███████▍  | 37/50 [00:11<00:03,  3.77it/s]Layer 12:  76%|███████▌  | 38/50 [00:11<00:03,  3.85it/s]Layer 12:  78%|███████▊  | 39/50 [00:11<00:02,  3.96it/s]Layer 12:  80%|████████  | 40/50 [00:11<00:02,  3.64it/s]Layer 12:  82%|████████▏ | 41/50 [00:12<00:02,  3.57it/s]Layer 12:  84%|████████▍ | 42/50 [00:12<00:02,  3.68it/s]Layer 12:  86%|████████▌ | 43/50 [00:12<00:01,  3.77it/s]Layer 12:  88%|████████▊ | 44/50 [00:12<00:01,  3.86it/s]Layer 12:  90%|█████████ | 45/50 [00:13<00:01,  3.65it/s]Layer 12:  92%|█████████▏| 46/50 [00:13<00:01,  3.57it/s]Layer 12:  94%|█████████▍| 47/50 [00:13<00:00,  3.58it/s]Layer 12:  96%|█████████▌| 48/50 [00:13<00:00,  3.71it/s]Layer 12:  98%|█████████▊| 49/50 [00:14<00:00,  3.77it/s]Layer 12: 100%|██████████| 50/50 [00:14<00:00,  3.86it/s]Layer 12: 100%|██████████| 50/50 [00:14<00:00,  3.45it/s]
  Vector norm: 3.1016

Extracting layer 14...
Layer 14:   0%|          | 0/50 [00:00<?, ?it/s]Layer 14:   2%|▏         | 1/50 [00:00<00:10,  4.82it/s]Layer 14:   4%|▍         | 2/50 [00:00<00:14,  3.36it/s]Layer 14:   6%|▌         | 3/50 [00:00<00:15,  3.04it/s]Layer 14:   8%|▊         | 4/50 [00:01<00:13,  3.38it/s]Layer 14:  10%|█         | 5/50 [00:01<00:13,  3.33it/s]Layer 14:  12%|█▏        | 6/50 [00:01<00:12,  3.39it/s]Layer 14:  14%|█▍        | 7/50 [00:02<00:11,  3.62it/s]Layer 14:  16%|█▌        | 8/50 [00:02<00:12,  3.43it/s]Layer 14:  18%|█▊        | 9/50 [00:02<00:11,  3.47it/s]Layer 14:  20%|██        | 10/50 [00:02<00:11,  3.60it/s]Layer 14:  22%|██▏       | 11/50 [00:03<00:10,  3.77it/s]Layer 14:  24%|██▍       | 12/50 [00:03<00:09,  3.84it/s]Layer 14:  26%|██▌       | 13/50 [00:03<00:09,  3.94it/s]Layer 14:  28%|██▊       | 14/50 [00:03<00:09,  3.94it/s]Layer 14:  30%|███       | 15/50 [00:04<00:09,  3.77it/s]Layer 14:  32%|███▏      | 16/50 [00:04<00:08,  3.87it/s]Layer 14:  34%|███▍      | 17/50 [00:04<00:08,  3.92it/s]Layer 14:  36%|███▌      | 18/50 [00:04<00:08,  3.80it/s]Layer 14:  38%|███▊      | 19/50 [00:05<00:08,  3.65it/s]Layer 14:  40%|████      | 20/50 [00:05<00:07,  3.76it/s]Layer 14:  42%|████▏     | 21/50 [00:05<00:07,  3.83it/s]Layer 14:  44%|████▍     | 22/50 [00:06<00:07,  3.70it/s]Layer 14:  46%|████▌     | 23/50 [00:06<00:07,  3.54it/s]Layer 14:  48%|████▊     | 24/50 [00:06<00:07,  3.69it/s]Layer 14:  50%|█████     | 25/50 [00:06<00:07,  3.45it/s]Layer 14:  52%|█████▏    | 26/50 [00:07<00:07,  3.39it/s]Layer 14:  54%|█████▍    | 27/50 [00:07<00:06,  3.52it/s]Layer 14:  56%|█████▌    | 28/50 [00:07<00:05,  3.67it/s]Layer 14:  58%|█████▊    | 29/50 [00:07<00:05,  3.78it/s]Layer 14:  60%|██████    | 30/50 [00:08<00:05,  3.64it/s]Layer 14:  62%|██████▏   | 31/50 [00:08<00:05,  3.80it/s]Layer 14:  64%|██████▍   | 32/50 [00:08<00:04,  3.90it/s]Layer 14:  66%|██████▌   | 33/50 [00:08<00:04,  3.97it/s]Layer 14:  68%|██████▊   | 34/50 [00:09<00:04,  3.65it/s]Layer 14:  70%|███████   | 35/50 [00:09<00:04,  3.55it/s]Layer 14:  72%|███████▏  | 36/50 [00:09<00:03,  3.66it/s]Layer 14:  74%|███████▍  | 37/50 [00:10<00:03,  3.79it/s]Layer 14:  76%|███████▌  | 38/50 [00:10<00:03,  3.89it/s]Layer 14:  78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]Layer 14:  80%|████████  | 40/50 [00:10<00:02,  3.72it/s]Layer 14:  82%|████████▏ | 41/50 [00:11<00:02,  3.62it/s]Layer 14:  84%|████████▍ | 42/50 [00:11<00:02,  3.74it/s]Layer 14:  86%|████████▌ | 43/50 [00:11<00:01,  3.83it/s]Layer 14:  88%|████████▊ | 44/50 [00:11<00:01,  3.93it/s]Layer 14:  90%|█████████ | 45/50 [00:12<00:01,  3.67it/s]Layer 14:  92%|█████████▏| 46/50 [00:12<00:01,  3.58it/s]Layer 14:  94%|█████████▍| 47/50 [00:12<00:00,  3.57it/s]Layer 14:  96%|█████████▌| 48/50 [00:13<00:00,  3.72it/s]Layer 14:  98%|█████████▊| 49/50 [00:13<00:00,  3.85it/s]Layer 14: 100%|██████████| 50/50 [00:13<00:00,  3.94it/s]Layer 14: 100%|██████████| 50/50 [00:13<00:00,  3.70it/s]
  Vector norm: 4.0391

Extracting layer 16...
Layer 16:   0%|          | 0/50 [00:00<?, ?it/s]Layer 16:   2%|▏         | 1/50 [00:00<00:10,  4.66it/s]Layer 16:   4%|▍         | 2/50 [00:00<00:14,  3.40it/s]Layer 16:   6%|▌         | 3/50 [00:00<00:15,  3.08it/s]Layer 16:   8%|▊         | 4/50 [00:01<00:13,  3.40it/s]Layer 16:  10%|█         | 5/50 [00:01<00:13,  3.34it/s]Layer 16:  12%|█▏        | 6/50 [00:01<00:12,  3.40it/s]Layer 16:  14%|█▍        | 7/50 [00:02<00:11,  3.64it/s]Layer 16:  16%|█▌        | 8/50 [00:02<00:12,  3.49it/s]Layer 16:  18%|█▊        | 9/50 [00:02<00:11,  3.50it/s]Layer 16:  20%|██        | 10/50 [00:02<00:11,  3.63it/s]Layer 16:  22%|██▏       | 11/50 [00:03<00:10,  3.77it/s]Layer 16:  24%|██▍       | 12/50 [00:03<00:09,  3.88it/s]Layer 16:  26%|██▌       | 13/50 [00:03<00:09,  3.97it/s]Layer 16:  28%|██▊       | 14/50 [00:03<00:08,  4.01it/s]Layer 16:  30%|███       | 15/50 [00:04<00:09,  3.74it/s]Layer 16:  32%|███▏      | 16/50 [00:04<00:08,  3.81it/s]Layer 16:  34%|███▍      | 17/50 [00:04<00:08,  3.80it/s]Layer 16:  36%|███▌      | 18/50 [00:04<00:08,  3.73it/s]Layer 16:  38%|███▊      | 19/50 [00:05<00:08,  3.59it/s]Layer 16:  40%|████      | 20/50 [00:05<00:07,  3.75it/s]Layer 16:  42%|████▏     | 21/50 [00:05<00:07,  3.89it/s]Layer 16:  44%|████▍     | 22/50 [00:05<00:07,  3.74it/s]Layer 16:  46%|████▌     | 23/50 [00:06<00:07,  3.55it/s]Layer 16:  48%|████▊     | 24/50 [00:06<00:07,  3.67it/s]Layer 16:  50%|█████     | 25/50 [00:06<00:07,  3.43it/s]Layer 16:  52%|█████▏    | 26/50 [00:07<00:07,  3.27it/s]Layer 16:  54%|█████▍    | 27/50 [00:07<00:06,  3.51it/s]Layer 16:  56%|█████▌    | 28/50 [00:07<00:06,  3.64it/s]Layer 16:  58%|█████▊    | 29/50 [00:07<00:05,  3.74it/s]Layer 16:  60%|██████    | 30/50 [00:08<00:05,  3.58it/s]Layer 16:  62%|██████▏   | 31/50 [00:08<00:05,  3.76it/s]Layer 16:  64%|██████▍   | 32/50 [00:08<00:04,  3.88it/s]Layer 16:  66%|██████▌   | 33/50 [00:08<00:04,  3.93it/s]Layer 16:  68%|██████▊   | 34/50 [00:09<00:04,  3.64it/s]Layer 16:  70%|███████   | 35/50 [00:09<00:04,  3.57it/s]Layer 16:  72%|███████▏  | 36/50 [00:09<00:03,  3.70it/s]Layer 16:  74%|███████▍  | 37/50 [00:10<00:03,  3.83it/s]Layer 16:  76%|███████▌  | 38/50 [00:10<00:03,  3.91it/s]Layer 16:  78%|███████▊  | 39/50 [00:10<00:02,  4.00it/s]Layer 16:  80%|████████  | 40/50 [00:10<00:02,  3.75it/s]Layer 16:  82%|████████▏ | 41/50 [00:11<00:02,  3.64it/s]Layer 16:  84%|████████▍ | 42/50 [00:11<00:02,  3.71it/s]Layer 16:  86%|████████▌ | 43/50 [00:11<00:01,  3.82it/s]Layer 16:  88%|████████▊ | 44/50 [00:11<00:01,  3.90it/s]Layer 16:  90%|█████████ | 45/50 [00:12<00:01,  3.64it/s]Layer 16:  92%|█████████▏| 46/50 [00:12<00:01,  3.57it/s]Layer 16:  94%|█████████▍| 47/50 [00:12<00:00,  3.59it/s]Layer 16:  96%|█████████▌| 48/50 [00:13<00:00,  3.74it/s]Layer 16:  98%|█████████▊| 49/50 [00:13<00:00,  3.81it/s]Layer 16: 100%|██████████| 50/50 [00:13<00:00,  3.83it/s]Layer 16: 100%|██████████| 50/50 [00:13<00:00,  3.69it/s]
  Vector norm: 5.6641

Extracting layer 18...
Layer 18:   0%|          | 0/50 [00:00<?, ?it/s]Layer 18:   2%|▏         | 1/50 [00:00<00:10,  4.74it/s]Layer 18:   4%|▍         | 2/50 [00:00<00:14,  3.34it/s]Layer 18:   6%|▌         | 3/50 [00:00<00:15,  3.04it/s]Layer 18:   8%|▊         | 4/50 [00:01<00:13,  3.38it/s]Layer 18:  10%|█         | 5/50 [00:01<00:13,  3.31it/s]Layer 18:  12%|█▏        | 6/50 [00:01<00:12,  3.39it/s]Layer 18:  14%|█▍        | 7/50 [00:02<00:12,  3.58it/s]Layer 18:  16%|█▌        | 8/50 [00:02<00:12,  3.46it/s]Layer 18:  18%|█▊        | 9/50 [00:02<00:12,  3.41it/s]Layer 18:  20%|██        | 10/50 [00:02<00:11,  3.58it/s]Layer 18:  22%|██▏       | 11/50 [00:03<00:10,  3.74it/s]Layer 18:  24%|██▍       | 12/50 [00:03<00:09,  3.84it/s]Layer 18:  26%|██▌       | 13/50 [00:03<00:09,  3.94it/s]Layer 18:  28%|██▊       | 14/50 [00:03<00:09,  3.92it/s]Layer 18:  30%|███       | 15/50 [00:04<00:09,  3.74it/s]Layer 18:  32%|███▏      | 16/50 [00:04<00:08,  3.81it/s]Layer 18:  34%|███▍      | 17/50 [00:04<00:08,  3.90it/s]Layer 18:  36%|███▌      | 18/50 [00:04<00:08,  3.76it/s]Layer 18:  38%|███▊      | 19/50 [00:05<00:08,  3.65it/s]Layer 18:  40%|████      | 20/50 [00:05<00:08,  3.73it/s]Layer 18:  42%|████▏     | 21/50 [00:05<00:07,  3.82it/s]Layer 18:  44%|████▍     | 22/50 [00:06<00:07,  3.68it/s]Layer 18:  46%|████▌     | 23/50 [00:06<00:07,  3.52it/s]Layer 18:  48%|████▊     | 24/50 [00:06<00:07,  3.70it/s]Layer 18:  50%|█████     | 25/50 [00:06<00:07,  3.44it/s]Layer 18:  52%|█████▏    | 26/50 [00:07<00:07,  3.39it/s]Layer 18:  54%|█████▍    | 27/50 [00:07<00:06,  3.51it/s]Layer 18:  56%|█████▌    | 28/50 [00:07<00:06,  3.65it/s]Layer 18:  58%|█████▊    | 29/50 [00:07<00:05,  3.74it/s]Layer 18:  60%|██████    | 30/50 [00:08<00:05,  3.61it/s]Layer 18:  62%|██████▏   | 31/50 [00:08<00:05,  3.77it/s]Layer 18:  64%|██████▍   | 32/50 [00:08<00:04,  3.87it/s]Layer 18:  66%|██████▌   | 33/50 [00:09<00:04,  3.95it/s]Layer 18:  68%|██████▊   | 34/50 [00:09<00:04,  3.65it/s]Layer 18:  70%|███████   | 35/50 [00:09<00:04,  3.53it/s]Layer 18:  72%|███████▏  | 36/50 [00:09<00:03,  3.64it/s]Layer 18:  74%|███████▍  | 37/50 [00:10<00:03,  3.76it/s]Layer 18:  76%|███████▌  | 38/50 [00:10<00:03,  3.87it/s]Layer 18:  78%|███████▊  | 39/50 [00:10<00:02,  3.97it/s]Layer 18:  80%|████████  | 40/50 [00:10<00:02,  3.71it/s]Layer 18:  82%|████████▏ | 41/50 [00:11<00:02,  3.63it/s]Layer 18:  84%|████████▍ | 42/50 [00:11<00:02,  3.73it/s]Layer 18:  86%|████████▌ | 43/50 [00:11<00:01,  3.85it/s]Layer 18:  88%|████████▊ | 44/50 [00:11<00:01,  3.94it/s]Layer 18:  90%|█████████ | 45/50 [00:12<00:01,  3.68it/s]Layer 18:  92%|█████████▏| 46/50 [00:12<00:01,  3.49it/s]Layer 18:  94%|█████████▍| 47/50 [00:12<00:00,  3.54it/s]Layer 18:  96%|█████████▌| 48/50 [00:13<00:00,  3.67it/s]Layer 18:  98%|█████████▊| 49/50 [00:13<00:00,  3.77it/s]Layer 18: 100%|██████████| 50/50 [00:13<00:00,  3.89it/s]Layer 18: 100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
  Vector norm: 7.5039

Extracting layer 20...
Layer 20:   0%|          | 0/50 [00:00<?, ?it/s]Layer 20:   2%|▏         | 1/50 [00:00<00:10,  4.83it/s]Layer 20:   4%|▍         | 2/50 [00:00<00:14,  3.40it/s]Layer 20:   6%|▌         | 3/50 [00:00<00:15,  3.10it/s]Layer 20:   8%|▊         | 4/50 [00:01<00:13,  3.40it/s]Layer 20:  10%|█         | 5/50 [00:01<00:13,  3.36it/s]Layer 20:  12%|█▏        | 6/50 [00:01<00:12,  3.39it/s]Layer 20:  14%|█▍        | 7/50 [00:02<00:11,  3.62it/s]Layer 20:  16%|█▌        | 8/50 [00:02<00:12,  3.45it/s]Layer 20:  18%|█▊        | 9/50 [00:02<00:11,  3.46it/s]Layer 20:  20%|██        | 10/50 [00:02<00:11,  3.57it/s]Layer 20:  22%|██▏       | 11/50 [00:03<00:10,  3.73it/s]Layer 20:  24%|██▍       | 12/50 [00:03<00:09,  3.85it/s]Layer 20:  26%|██▌       | 13/50 [00:03<00:09,  3.94it/s]Layer 20:  28%|██▊       | 14/50 [00:03<00:09,  3.94it/s]Layer 20:  30%|███       | 15/50 [00:04<00:09,  3.70it/s]Layer 20:  32%|███▏      | 16/50 [00:04<00:08,  3.78it/s]Layer 20:  34%|███▍      | 17/50 [00:04<00:08,  3.85it/s]Layer 20:  36%|███▌      | 18/50 [00:04<00:08,  3.75it/s]Layer 20:  38%|███▊      | 19/50 [00:05<00:08,  3.60it/s]Layer 20:  40%|████      | 20/50 [00:05<00:07,  3.77it/s]Layer 20:  42%|████▏     | 21/50 [00:05<00:07,  3.85it/s]Layer 20:  44%|████▍     | 22/50 [00:06<00:07,  3.71it/s]Layer 20:  46%|████▌     | 23/50 [00:06<00:07,  3.54it/s]Layer 20:  48%|████▊     | 24/50 [00:06<00:06,  3.72it/s]Layer 20:  50%|█████     | 25/50 [00:06<00:07,  3.44it/s]Layer 20:  52%|█████▏    | 26/50 [00:07<00:07,  3.37it/s]Layer 20:  54%|█████▍    | 27/50 [00:07<00:06,  3.52it/s]Layer 20:  56%|█████▌    | 28/50 [00:07<00:06,  3.64it/s]Layer 20:  58%|█████▊    | 29/50 [00:07<00:05,  3.73it/s]Layer 20:  60%|██████    | 30/50 [00:08<00:05,  3.56it/s]Layer 20:  62%|██████▏   | 31/50 [00:08<00:05,  3.76it/s]Layer 20:  64%|██████▍   | 32/50 [00:08<00:04,  3.86it/s]Layer 20:  66%|██████▌   | 33/50 [00:09<00:04,  3.91it/s]Layer 20:  68%|██████▊   | 34/50 [00:09<00:04,  3.63it/s]Layer 20:  70%|███████   | 35/50 [00:09<00:04,  3.58it/s]Layer 20:  72%|███████▏  | 36/50 [00:09<00:03,  3.69it/s]Layer 20:  74%|███████▍  | 37/50 [00:10<00:03,  3.82it/s]Layer 20:  76%|███████▌  | 38/50 [00:10<00:03,  3.91it/s]Layer 20:  78%|███████▊  | 39/50 [00:10<00:02,  3.99it/s]Layer 20:  80%|████████  | 40/50 [00:10<00:02,  3.71it/s]Layer 20:  82%|████████▏ | 41/50 [00:11<00:02,  3.63it/s]Layer 20:  84%|████████▍ | 42/50 [00:11<00:02,  3.67it/s]Layer 20:  86%|████████▌ | 43/50 [00:11<00:01,  3.75it/s]Layer 20:  88%|████████▊ | 44/50 [00:11<00:01,  3.85it/s]Layer 20:  90%|█████████ | 45/50 [00:12<00:01,  3.61it/s]Layer 20:  92%|█████████▏| 46/50 [00:12<00:01,  3.58it/s]Layer 20:  94%|█████████▍| 47/50 [00:12<00:00,  3.55it/s]Layer 20:  96%|█████████▌| 48/50 [00:13<00:00,  3.72it/s]Layer 20:  98%|█████████▊| 49/50 [00:13<00:00,  3.81it/s]Layer 20: 100%|██████████| 50/50 [00:13<00:00,  3.88it/s]Layer 20: 100%|██████████| 50/50 [00:13<00:00,  3.68it/s]
  Vector norm: 9.2344

Testing vector effectiveness...

Testing layer 12...

Testing layer 14...

Testing layer 16...

Testing layer 18...

Testing layer 20...


 Refusal Rates by Layer (mistralai/Mistral-7B-Instruct-v0.2)  
┏━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━┓
┃ Layer ┃ s=0.0 (base) ┃ s=0.5 ┃ s=1.0 ┃ s=1.5 ┃ Improvement ┃
┡━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━┩
│ 12    │ 75%          │ 100%  │ 100%  │ 100%  │ +25%        │
│ 14    │ 75%          │ 75%   │ 25%   │ 0%    │ -50%        │
│ 16    │ 75%          │ 75%   │ 75%   │ 25%   │ +0%         │
│ 18    │ 75%          │ 75%   │ 50%   │ 50%   │ -25%        │
│ 20    │ 75%          │ 75%   │ 50%   │ 75%   │ -25%        │
└───────┴──────────────┴───────┴───────┴───────┴─────────────┘

Best layer: 12 (improvement: +25%)

Checking false positives on benign prompts...
  Base (s=0.0): 0% false positive
  Steered (s=1.0): 0% false positive

Saving vectors to data/vectors/refusal_mistral_7b_instruct_v0.2...
Done!

Summary:
  Model: mistralai/Mistral-7B-Instruct-v0.2
  Best layer: 12
  Base refusal rate: 75%
  Steered refusal rate (s=1.0): 100%
  Improvement: +25%
